<!DOCTYPE html>
<!-- saved from url=(0034)https://m.mengfm.com/show/* -->
<html data-dpr="1" style="font-size: 39px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>剧本演绎秀在线收听-麦萌对手戏</title>
	<meta name="flexible" content="initial-dpr=1">
	<meta name="HandheldFriendly" content="true">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="application-device" content="mobile">
	<meta name="renderer" content="webkit">
	<meta name="keywords" content="在线收听,mp3录音">
	<meta name="description" content="欢迎收听剧本演绎秀">
	<meta name="browsermode" content="application">
	<meta name="x5-page-mode" content="app">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
	<link rel="bookmark" type="image/x-icon" href="./favicon.ico">
	<script type="text/javascript" src="./assets/js/jquery-3.1.1.min.js"></script>
	<script type="text/javascript" src="./assets/js/loaders.css.js"></script>
	<script type="text/javascript" src="./assets/js/Utils.js"></script>
	<script type="text/javascript" src="./assets/js/mobilePlayer.js"></script>
	<script type="text/javascript" src="./assets/js/equipment.js"></script>
	<script type="text/javascript" src="./assets/js/flexible_css.js"></script>
	<script type="text/javascript" src="./assets/js/flexible.js"></script>
	<link rel="stylesheet" type="text/css" href="./assets/css/normalize.css">
	<link rel="stylesheet" type="text/css" href="./assets/css/loaders.css">
	<link rel="stylesheet" type="text/css" href="./assets/css/main.css">
	<link rel="stylesheet" type="text/css" href="./assets/css/showplay-98e61c1cde.css">
	<link rel="apple-mobile-web-app-title" content="麦萌">
	<link rel="apple-touch-icon" sizes="72x72" href="./assets/image/share-logo-72x72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="./assets/image/share-logo-144x144.png">
	<link rel="apple-touch-icon" sizes="512x512" href="./assets/image/share-logo.png">
	<link rel="manifest" href="./manifest.json">
	<style>
		.script-intro{
			background: white;
			border-bottom: 1px solid #eee;
			padding: 0.3rem 0.3rem 0.3rem 1.1rem;
		}
		.role-info{
			padding-bottom: 0;
			border-bottom: 0;
		}
		.hidden{
			display: none;
		}
	</style>
    <script src="./assets/js/Utils.js"></script>
	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "https://hm.baidu.com/hm.js?b55f1bc0726616c96ff3bcf0450a31b1";
	  var s = document.getElementsByTagName("script")[0];
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

</head>
<body style="font-size: 12px;">
	<div class="container">
		<header>
			<div class="menu">
				<a href="javascript:history.go(-1);"><img class="back-icon pull-left" src="./assets/image/back-black-icon.png"></a>
				<a href="./index.html"><img class="home-icon pull-right" src="./assets/image/home-black-icon.png"></a>
				<h1 id="show-title">加载中...</h1>
			</div>
		</header>
		<section id="showContainer" style="position:relative;z-index:1;width:100%;height:390px;background-color:black;display:block;overflow:hidden;">
            <div id="showPlay">
            <img id="showCover" src="" style="width: 100%">
                <div id="showDialogue">
                    <div id="roleInfo">
                        <img id="roleIcon" src="./assets/image/user-default-icon.png">
                        <span id="roleName"></span>
                    </div>
                    <div id="lines"></div>
                </div>
            </div>
        </section>

        <section class="show-info-content hidden" id="show-info-content">
            <div class="show-info">
                <div class="user-icon-box">
                    <img alt="" class="user-icon no-img-src" id="user-icon" src="">
                </div>
                <span class="user-name" id="user-name"></span>
                <p class="show-intro" id="show-intro"></p>
            </div>
            <a class="script-info" >
                <span class="script-title">剧本</span>
                <div class="script-cover-box">
                    <img alt="" class="script-cover" id="script-cover" src="">
                </div>

                <div class="name-info">
                    <span class="script-name" id="script-name"></span>
                    <div class="editor-name" id="show-add-time"></div>
                </div>
            </a>

			<div class="role-info" id="author-info">
                <span class="role-main-title">编剧</span>
				<a class="role" >
                    <div class="role-icon-box no-img-src">
                        <img alt="" class="user-icon" id="author-icon" src="">
                    </div>
                    <div>
                        <span class="user-name" id="author-name"></span>
                    </div>
                    <div class="role-name" id="author-intro"></div>
                </a>

            </div>
			<div class="script-intro">
			<span id="script-intro"></span>
			</div>

            <div class="role-info" id="role-info">
                <span class="role-main-title">主演</span>
            </div>
        </section>

        <script>
            function getQueryString(name) {
                let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
                let r = window.location.search.substr(1).match(reg);
                if (r != null) return unescape(r[2]);
                return null;
            }

			function timestampToTime(timestamp) {
				try{
					let  date = new Date(timestamp * 1000);
					let Y = date.getFullYear() + '年';
					let M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '月';
					let D = date.getDate() + '日 ';
					let h = date.getHours() + ':';
					let m = date.getMinutes()// + ':';
					// let s = date.getSeconds();
					return Y+M+D+h+m;
				} catch (e) {
					return ""
				}
			}

            let show_id = getQueryString('show')
            if(!show_id){
                console.log('错误的请求')
            } else {
                console.log(show_id)
            }


            var browser = equipment()
            var utils = new Utils();
            var series_id = 0;
            if(!browser['mobile']){
                window.location.href=`./pc_show.html?show=${show_id}`;
            }

			_hmt.push(["_trackEvent","meng","mobile",show_id])

			fetch(`./data/${show_id}/info_local.json`).then(data => {
				$("#show-info-content").removeClass('hidden');
				return data.json()
			}).then(data => {
				let evalShowInfo = data
				console.log(data)
				//初始化界面
				$("#show-title").text(evalShowInfo['script_info']['script_name'])
				$("#script-name").text(evalShowInfo['script_info']['script_name'])
				$("#user-name").text(evalShowInfo['user_info']['user_name'])
				$("#show-intro").text(evalShowInfo['show_intro'])
				$("#user-icon").attr('src', evalShowInfo['user_info']['user_icon'])
				let script_cover  = evalShowInfo['script_info']['script_cover']
				$("#showCover").attr('src', script_cover)
				$("#script-cover").attr('src', script_cover)
				if(evalShowInfo['dialogues'][0]['dialogue_image']){
					script_cover = evalShowInfo['dialogues'][0]['dialogue_image']
				}
				$("#showCover").attr('src', script_cover)
				if(evalShowInfo['script_info']['user_info']) {
					$("#author-name").text(evalShowInfo['script_info']['user_info']['user_name'])
					$("#author-icon").attr('src', evalShowInfo['script_info']['user_info']['user_icon'])
				}
				$("#show-add-time").text(timestampToTime(evalShowInfo['show_add_time']))

				if(evalShowInfo['script_info']['script_intro']){
					$("#script-intro").append($(`<span>
					${evalShowInfo['script_info']['script_intro'].replace(new RegExp("\n", "gm"), '<br/>')}
					</span>`))
				}
				let roles = evalShowInfo['show_role']
				for(let r in roles){
					let role = $(`
					<a class="role" >
						<div class="role-icon-box no-img-src">
							<img alt="" class="user-icon" src="${roles[r]['user_icon']}">
						</div>
						<div>
							<span class="user-name">${roles[r]['user_name']}</span>
						</div>
						<div class="role-name">${roles[r]['role_name']}</div>
					</a>`)
					$("#role-info").append(role)
				}

				//初始化播放器
				new player({
					type : 'show',
					playInfo : evalShowInfo,
					playerEle : 'showContainer',
					callBack : {
						error : function(msg){
							alert(msg);
						},
						onloaded : function(obj){
						}
					}
				});
			})
        </script>

	</div>
	<footer class="footer">
		<div id="loading" class="ball-clip-rotate text-center hide">
			<div></div>
		</div>
		<br/>
		<br/>
	</footer>


<!--layer务必放在文档底部-->
<script type="text/javascript" src="./assets/js/showplay.js"></script>
</body></html>